[{"/Users/josse/Projects/booking/src/index.js":"1","/Users/josse/Projects/booking/src/serviceWorker.js":"2","/Users/josse/Projects/booking/src/App.js":"3","/Users/josse/Projects/booking/src/components/footer.js":"4","/Users/josse/Projects/booking/src/components/header.js":"5","/Users/josse/Projects/booking/src/components/bookables.js":"6","/Users/josse/Projects/booking/src/components/i18n.js":"7","/Users/josse/Projects/booking/src/components/header-mobile.js":"8","/Users/josse/Projects/booking/src/components/menu.js":"9","/Users/josse/Projects/booking/src/components/food.js":"10","/Users/josse/Projects/booking/src/components/lodging.js":"11","/Users/josse/Projects/booking/src/components/tabs.js":"12","/Users/josse/Projects/booking/src/components/dateselector.js":"13","/Users/josse/Projects/booking/src/components/tab.js":"14","/Users/josse/Projects/booking/src/pages/checkout.js":"15","/Users/josse/Projects/booking/src/components/selected.js":"16","/Users/josse/Projects/booking/src/components/scrollToTop.js":"17","/Users/josse/Projects/booking/src/pages/confirmation.js":"18","/Users/josse/Projects/booking/src/components/rental.js":"19","/Users/josse/Projects/booking/src/components/camp.js":"20"},{"size":545,"mtime":1610089959218,"results":"21","hashOfConfig":"22"},{"size":5085,"mtime":1584349835710,"results":"23","hashOfConfig":"22"},{"size":6615,"mtime":1611168593792,"results":"24","hashOfConfig":"22"},{"size":3592,"mtime":1610525507289,"results":"25","hashOfConfig":"22"},{"size":1919,"mtime":1608541365724,"results":"26","hashOfConfig":"22"},{"size":6608,"mtime":1611173220609,"results":"27","hashOfConfig":"22"},{"size":2274,"mtime":1610806228957,"results":"28","hashOfConfig":"22"},{"size":5789,"mtime":1608544722472,"results":"29","hashOfConfig":"22"},{"size":1957,"mtime":1608653811231,"results":"30","hashOfConfig":"22"},{"size":3742,"mtime":1611173191807,"results":"31","hashOfConfig":"22"},{"size":2585,"mtime":1610698458877,"results":"32","hashOfConfig":"22"},{"size":1564,"mtime":1609917172570,"results":"33","hashOfConfig":"22"},{"size":1456,"mtime":1610803099155,"results":"34","hashOfConfig":"22"},{"size":867,"mtime":1609917167424,"results":"35","hashOfConfig":"22"},{"size":6112,"mtime":1611003625508,"results":"36","hashOfConfig":"22"},{"size":2861,"mtime":1611047787390,"results":"37","hashOfConfig":"22"},{"size":344,"mtime":1609258129151,"results":"38","hashOfConfig":"22"},{"size":3167,"mtime":1610561325128,"results":"39","hashOfConfig":"22"},{"size":3695,"mtime":1610802508558,"results":"40","hashOfConfig":"22"},{"size":2437,"mtime":1611046470836,"results":"41","hashOfConfig":"22"},{"filePath":"42","messages":"43","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},"1kmy3j2",{"filePath":"45","messages":"46","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"47","messages":"48","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"49","messages":"50","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"51","messages":"52","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"53","messages":"54","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"55","messages":"56","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"57","messages":"58","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"59","messages":"60","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"61","messages":"62","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"63","messages":"64","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"65","messages":"66","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"67","messages":"68","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"69","messages":"70","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"71","messages":"72","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"73","usedDeprecatedRules":"44"},{"filePath":"74","messages":"75","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"76","messages":"77","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"78","messages":"79","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"80","messages":"81","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"82","messages":"83","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},"/Users/josse/Projects/booking/src/index.js",[],["84","85"],"/Users/josse/Projects/booking/src/serviceWorker.js",[],"/Users/josse/Projects/booking/src/App.js",[],"/Users/josse/Projects/booking/src/components/footer.js",[],"/Users/josse/Projects/booking/src/components/header.js",[],"/Users/josse/Projects/booking/src/components/bookables.js",["86"],"/Users/josse/Projects/booking/src/components/i18n.js",[],"/Users/josse/Projects/booking/src/components/header-mobile.js",[],"/Users/josse/Projects/booking/src/components/menu.js",[],"/Users/josse/Projects/booking/src/components/food.js",[],"/Users/josse/Projects/booking/src/components/lodging.js",[],"/Users/josse/Projects/booking/src/components/tabs.js",[],"/Users/josse/Projects/booking/src/components/dateselector.js",[],"/Users/josse/Projects/booking/src/components/tab.js",[],"/Users/josse/Projects/booking/src/pages/checkout.js",["87"],"import React from 'react';\nimport {\n    BrowserRouter as Router, // eslint-disable-line\n    Link,\n    withRouter\n  } from 'react-router-dom';\nimport moment from 'moment';\nimport { DateTime } from 'luxon';\nimport Selected from '../components/selected.js';\nimport i18n from '../components/i18n';\n\nclass Checkout extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            selected: [],\n            discount: \"\",\n            discountMessage: \" \",\n            valid: \"notvalid\",\n            approved: false,\n        }\n        this.klarnaHtmlSnippet = React.createRef();\n        this.handleDiscountChange = this.handleDiscountChange.bind(this);\n        this.verifyDiscount = this.verifyDiscount.bind(this);\n        this.approvedChange = this.approvedChange.bind(this);\n    }\n    componentDidUpdate() {\n        if(this.props.location.state && this.state.approved) {\n            this.fetchCheckout();\n        } else {\n            this.klarnaHtmlSnippet.current.innerHTML = i18n.t('checkout.approve');\n        }\n    }\n    handleBookableChange(data) {\n        this.props.onBookableChange(data);\n    }\n    handleBookableRemove(data) {\n        this.props.onBookableRemove(data);\n    }\n    fetchCheckout() {\n        let data = {\n            \"products\": [...this.props.location.state.orderLines.map(selected => {\n                return ({\"id\": selected.productId, \"quantity\": selected.quantity, \"startDate\": selected.startDate, \"endDate\": selected.endDate } )\n            })]\n        };\n      \n        data = JSON.stringify(data);\n        fetch('https://api.test.naturlogi.se/api/order/checkout', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: data\n        })\n        .then((response) => {\n            return response.json();\n        })\n        .then((data) => {\n            this.klarnaHtmlSnippet.current.innerHTML = data.klarnaHtmlSnippet;\n            const scriptsTags = this.klarnaHtmlSnippet.current.getElementsByTagName('script');\n            for (let i = 0; i < scriptsTags.length; i++) {\n                const parentNode = scriptsTags[i].parentNode;\n                const newScriptTag = document.createElement('script');\n                newScriptTag.type = 'text/javascript';\n                newScriptTag.text = scriptsTags[i].text;\n                parentNode.removeChild(scriptsTags[i]);\n                parentNode.appendChild(newScriptTag);\n            }\n        });\n    }\n    /* renderKlarna(snippet) {\n        return (parse(snippet));\n    } */\n    handleDiscountChange(event) {\n        this.setState({discount: event.target.value});\n      }\n/*     verifyDiscount(e) {\n        console.log(\"verify this: \" + this.state.discount)\n        if(this.state.discount === 'valid') {\n            this.setState({\n                discountMessage: \"Verifierad\",\n                valid: \"valid\",\n            });\n        } else {\n            this.setState({\n                discountMessage: \"Ej giltig\",\n                valid: \"notvalid\",\n            });\n        }\n    } */\n    verifyDiscount(e) {\n        console.log(\"verify this: \" + this.state.discount)\n        let data = {\n            \"products\": [...this.props.location.state.orderLines.map(selected => {\n                const startDate = selected.startDate ? moment(selected.startDate).format(\"YYYY-MM-DD\") : '';\n                const endDate = selected.endDate ? moment(selected.endDate).format(\"YYYY-MM-DD\") : '';\n                return ({\"id\": selected.productId, \"quantity\": selected.quantity, \"startDate\": startDate, \"endDate\": endDate } )\n            })],\n            \"couponCode\": this.state.discount\n        };\n\n        data = JSON.stringify(data);\n        fetch('https://api.test.naturlogi.se/api/order/validate', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: data\n        })\n            .then((response) => {\n                return response.json();\n            })\n            .then((data) => {\n                if (data.id) {\n                    console.log(data)\n                } else {\n                    console.warn(data)\n                    this.setState(prevState => {\n                        return { error: data.title }\n                    });\n                }\n            });\n    }\n    approvedChange = () => {\n        this.setState(prevState => {\n            return { approved: prevState.approved === false }\n        });\n    }\n    render() {\n        return (\n            <div className=\"checkout\">\n                <Link to={{ pathname: \"/boka\", state: this.state}} className=\"button\" >Tillbaka</Link>\n                {/* <h2>Checkout</h2> */}\n                \n                <div className=\"extraInfo\">\n                    <label htmlFor=\"other\">Övrig info</label>\n                    <textarea name=\"other\" type=\"text\" placeholder=\"Ange eventuella matpreferenser eller andra önskemål när det gäller din bokning.\"/>\n\n                    <label htmlFor=\"discount\">Rabattkod/Presentkort</label>\n                    <input name=\"discount\" type=\"text\" value={this.state.discount} onChange={this.handleDiscountChange}/>\n                    <div>\n                        <span className={this.state.valid}>{this.state.discountMessage}</span>\n                        <button className=\"verifyDiscount button\" onClick={this.verifyDiscount} >Verifiera</button>\n                    </div>\n                </div>\n                <div className=\"approve\">\n                    <input type=\"checkbox\" checked={this.state.approved} onChange={this.approvedChange}></input>\n                    <label>Godkänn <a href=\"https://naturlogi.se/bokningsvillkor/\" alt=\"bokningsvillkoren\">bokningsvillkoren</a></label>\n                </div>\n                <Selected selectedItems={this.props.selectedItems} onBookableRemove={this.handleBookableRemove} onBookableChange={this.handleBookableChange}></Selected>\n                <div id=\"klarnaHtmlSnippet\" ref={this.klarnaHtmlSnippet}>{i18n.t('checkout.approve')}</div>\n            </div>\n        );\n    }\n}\n\nexport default withRouter(Checkout);\n","/Users/josse/Projects/booking/src/components/selected.js",[],"/Users/josse/Projects/booking/src/components/scrollToTop.js",[],"/Users/josse/Projects/booking/src/pages/confirmation.js",[],"/Users/josse/Projects/booking/src/components/rental.js",[],"/Users/josse/Projects/booking/src/components/camp.js",[],{"ruleId":"88","replacedBy":"89"},{"ruleId":"90","replacedBy":"91"},{"ruleId":"92","severity":1,"message":"93","line":93,"column":19,"nodeType":"94","messageId":"95","endLine":93,"endColumn":24},{"ruleId":"92","severity":1,"message":"96","line":8,"column":10,"nodeType":"94","messageId":"95","endLine":8,"endColumn":18},"no-native-reassign",["97"],"no-negated-in-lhs",["98"],"no-unused-vars","'dates' is assigned a value but never used.","Identifier","unusedVar","'DateTime' is defined but never used.","no-global-assign","no-unsafe-negation"]